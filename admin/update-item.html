<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update Item</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-yellow-100 w-screen">
    <div class="w-60 h-full shadow-md bg-white absolute" id="sidenavSecExample">
        <div class="pt-4 pb-2 px-6">
          <a href="#!">
            <div class="flex items-center">
              <div class="shrink-0">
                <img src="https://mdbcdn.b-cdn.net/img/new/avatars/8.webp" class="rounded-full w-10" alt="Avatar">
              </div>
              <div class="grow ml-3">
                <p class="text-sm font-semibold text-yellow-500">Samsul 'O Samsul</p>
              </div>
            </div>
          </a>
        </div>
        <ul class="relative px-1">
          <li class="relative">
            <a class="flex items-center text-sm py-4 px-6 h-12 overflow-hidden text-gray-700 text-ellipsis whitespace-nowrap rounded hover:text-blue-600 hover:bg-blue-50 transition duration-300 ease-in-out" href="#!" data-mdb-ripple="true" data-mdb-ripple-color="primary">
              <svg aria-hidden="true" focusable="false" data-prefix="fas" class="w-3 h-3 mr-3" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                <path fill="currentColor" d="M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"></path>
              </svg>
              <span>Dashboard</span>
            </a>
          </li>
        </ul>
        <hr class="my-2">
        <ul class="relative px-1">
          <li class="relative">
            <a class="flex items-center text-sm py-4 px-6 h-12 overflow-hidden text-gray-700 text-ellipsis whitespace-nowrap rounded hover:text-blue-600 hover:bg-blue-50 transition duration-300 ease-in-out" href="#!" data-mdb-ripple="true" data-mdb-ripple-color="primary">
              <svg aria-hidden="true" focusable="false" data-prefix="fas" class="w-3 h-3 mr-3" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                <path fill="currentColor" d="M488.6 250.2L392 214V105.5c0-15-9.3-28.4-23.4-33.7l-100-37.5c-8.1-3.1-17.1-3.1-25.3 0l-100 37.5c-14.1 5.3-23.4 18.7-23.4 33.7V214l-96.6 36.2C9.3 255.5 0 268.9 0 283.9V394c0 13.6 7.7 26.1 19.9 32.2l100 50c10.1 5.1 22.1 5.1 32.2 0l103.9-52 103.9 52c10.1 5.1 22.1 5.1 32.2 0l100-50c12.2-6.1 19.9-18.6 19.9-32.2V283.9c0-15-9.3-28.4-23.4-33.7zM358 214.8l-85 31.9v-68.2l85-37v73.3zM154 104.1l102-38.2 102 38.2v.6l-102 41.4-102-41.4v-.6zm84 291.1l-85 42.5v-79.1l85-38.8v75.4zm0-112l-102 41.4-102-41.4v-.6l102-38.2 102 38.2v.6zm240 112l-85 42.5v-79.1l85-38.8v75.4zm0-112l-102 41.4-102-41.4v-.6l102-38.2 102 38.2v.6z"></path>
              </svg>
              <span>Manage User</span>
            </a>
          </li>
          <li class="relative">
            <a class="flex items-center text-sm py-4 px-6 h-12 overflow-hidden text-gray-700 text-ellipsis whitespace-nowrap rounded hover:text-blue-600 hover:bg-blue-50 transition duration-300 ease-in-out" href="#!" data-mdb-ripple="true" data-mdb-ripple-color="primary">
              <svg aria-hidden="true" focusable="false" data-prefix="fas" class="w-3 h-3 mr-3" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                <path fill="currentColor" d="M488.6 250.2L392 214V105.5c0-15-9.3-28.4-23.4-33.7l-100-37.5c-8.1-3.1-17.1-3.1-25.3 0l-100 37.5c-14.1 5.3-23.4 18.7-23.4 33.7V214l-96.6 36.2C9.3 255.5 0 268.9 0 283.9V394c0 13.6 7.7 26.1 19.9 32.2l100 50c10.1 5.1 22.1 5.1 32.2 0l103.9-52 103.9 52c10.1 5.1 22.1 5.1 32.2 0l100-50c12.2-6.1 19.9-18.6 19.9-32.2V283.9c0-15-9.3-28.4-23.4-33.7zM358 214.8l-85 31.9v-68.2l85-37v73.3zM154 104.1l102-38.2 102 38.2v.6l-102 41.4-102-41.4v-.6zm84 291.1l-85 42.5v-79.1l85-38.8v75.4zm0-112l-102 41.4-102-41.4v-.6l102-38.2 102 38.2v.6zm240 112l-85 42.5v-79.1l85-38.8v75.4zm0-112l-102 41.4-102-41.4v-.6l102-38.2 102 38.2v.6z"></path>
              </svg>
              <span>Manage Item</span>
            </a>
          </li>
          <li class="relative">
            <a class="flex items-center text-sm py-4 px-6 h-12 overflow-hidden text-gray-700 text-ellipsis whitespace-nowrap rounded hover:text-blue-600 hover:bg-blue-50 transition duration-300 ease-in-out" href="#!" data-mdb-ripple="true" data-mdb-ripple-color="primary">
              <svg aria-hidden="true" focusable="false" data-prefix="fas" class="w-3 h-3 mr-3" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                <path fill="currentColor" d="M488.6 250.2L392 214V105.5c0-15-9.3-28.4-23.4-33.7l-100-37.5c-8.1-3.1-17.1-3.1-25.3 0l-100 37.5c-14.1 5.3-23.4 18.7-23.4 33.7V214l-96.6 36.2C9.3 255.5 0 268.9 0 283.9V394c0 13.6 7.7 26.1 19.9 32.2l100 50c10.1 5.1 22.1 5.1 32.2 0l103.9-52 103.9 52c10.1 5.1 22.1 5.1 32.2 0l100-50c12.2-6.1 19.9-18.6 19.9-32.2V283.9c0-15-9.3-28.4-23.4-33.7zM358 214.8l-85 31.9v-68.2l85-37v73.3zM154 104.1l102-38.2 102 38.2v.6l-102 41.4-102-41.4v-.6zm84 291.1l-85 42.5v-79.1l85-38.8v75.4zm0-112l-102 41.4-102-41.4v-.6l102-38.2 102 38.2v.6zm240 112l-85 42.5v-79.1l85-38.8v75.4zm0-112l-102 41.4-102-41.4v-.6l102-38.2 102 38.2v.6z"></path>
              </svg>
              <span>Manage Courier</span>
            </a>
          </li>
        </ul>
        <div class="text-center bottom-0 absolute w-full">
          <hr class="m-0">
          <p class="py-2 text-sm text-gray-700 font-semibold">BoxesAway</p>
        </div>
      </div>
      <div class="p-12 h-screen ml-60">
        <h1 class="mb-12 text-xl text-yellow-500 tracking-wider font-semibold">UPDATE ITEM</h1>
        <div class="mt-5 md:mt-0 md:col-span-2">
              <div class="shadow overflow-hidden sm:rounded-md">
                <div class="px-4 py-5 bg-white sm:p-6">
                  <div class="grid grid-cols-6 gap-6">
                    <div class="col-span-6 sm:col-span-3">
                      <label for="first-name" class="block text-sm font-medium text-gray-700">Sender Name</label>
                      <input disabled type="text" name="first-name" id="sender_name" autocomplete="given-name" class="bg-gray-50 mt-1 px-3 py-2 focus:ring-yellow-500 focus:border-yellow-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                    </div>
      
                    <div class="col-span-6 sm:col-span-3">
                      <label for="last-name" class="block text-sm font-medium text-gray-700">Receiver Name</label>
                      <input disabled type="text" name="last-name" id="receiver_name" autocomplete="family-name" class="bg-gray-50 mt-1 px-3 py-2 focus:ring-yellow-500 focus:border-yellow-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                    </div>
                    
                    <div class="col-span-6 sm:col-span-3">
                        <label for="first-name" class="block text-sm font-medium text-gray-700">Sender Email</label>
                        <input disabled type="text" name="first-name" id="sender_email" autocomplete="given-name" class="bg-gray-50 mt-1 px-3 py-2 focus:ring-yellow-500 focus:border-yellow-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                      </div>
        
                      <div class="col-span-6 sm:col-span-3">
                        <label for="last-name" class="block text-sm font-medium text-gray-700">Receiver Contact</label>
                        <input disabled type="text" name="last-name" id="receiver_contact" autocomplete="family-name" class="bg-gray-50 mt-1 px-3 py-2 focus:ring-yellow-500 focus:border-yellow-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                      </div>
      
                      <div class="col-span-6 sm:col-span-3">
                        <label for="first-name" class="block text-sm font-medium text-gray-700">Sender Contact</label>
                        <input disabled type="text" name="first-name" id="sender_contact" autocomplete="given-name" class="bg-gray-50 mt-1 px-3 py-2 focus:ring-yellow-500 focus:border-yellow-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                      </div>
        
                      <div class="col-span-6 sm:col-span-3">
                        <label for="last-name" class="block text-sm font-medium text-gray-700">Receiver Address</label>
                        <input disabled type="text" name="last-name" id="receiver_address" autocomplete="family-name" class="bg-gray-50 mt-1 px-3 py-2 focus:ring-yellow-500 focus:border-yellow-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                      </div>
                      
                      <div class="col-span-6 sm:col-span-3">
                        <label for="first-name" class="block text-sm font-medium text-gray-700">Sender Address</label>
                        <input disabled type="text" name="first-name" id="sender_address" autocomplete="given-name" class="bg-gray-50 mt-1 px-3 py-2 focus:ring-yellow-500 focus:border-yellow-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                      </div>
                      
                    <div class="col-span-6 sm:col-span-6">
                      <label for="email-address" class="block text-sm font-medium text-gray-700">Item Description</label>
                      <input disabled type="text" name="email-address" id="item_desc" autocomplete="email" class="bg-gray-50 mt-1 px-3 py-2 focus:ring-yellow-500 focus:border-yellow-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                    </div>
                    
                    <div class="col-span-6 sm:col-span-3">
                        <label for="last-name" class="block text-sm font-medium text-gray-700">Item Weight (Kg)</label>
                        <input disabled type="text" name="last-name" id="item_weight" autocomplete="family-name" class="bg-gray-50 mt-1 px-3 py-2 focus:ring-yellow-500 focus:border-yellow-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                      </div>
                      
                      <div class="col-span-6 sm:col-span-3">
                        <label for="first-name" class="block text-sm font-medium text-gray-700">Item Price (Rp)</label>
                        <input type="text" name="first-name" id="item_price" autocomplete="given-name" class="bg-gray-50 mt-1 px-3 py-2 focus:ring-yellow-500 focus:border-yellow-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                      </div>
                      
                    <div class="col-span-6 sm:col-span-3">
                    <label for="country" class="block text-sm font-medium text-gray-700">Status</label>
                    <select id="status" name="country" autocomplete="country-name" class="bg-gray-50 mt-1 block w-full py-2 px-3 bg-white rounded-md shadow-sm focus:outline-none focus:ring-yellow-500 focus:border-yellow-500 sm:text-sm">
                    </select>
                    </div>
      
                    <div class="col-span-6 sm:col-span-3">
                      <label for="country" class="block text-sm font-medium text-gray-700">Courier</label>
                      <select id="courier" name="country" autocomplete="country-name" class="bg-gray-50 mt-1 block w-full py-2 px-3 bg-white rounded-md shadow-sm focus:outline-none focus:ring-yellow-500 focus:border-yellow-500 sm:text-sm">
                      </select>
                    </div>
                  </div>
                </div>
                <div class="px-4 py-3 bg-gray-50 text-right sm:px-6">
                  <button onclick="updateItem()" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-yellow-500 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500">Save</button>
                </div>
              </div>
          </div>
      </div>
</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script>
    const params = new URLSearchParams(window.location.search)
    
    var id = null;
    
    if (params.has('id')) {
        id = params.get('id');
        console.log('id: ' + id);
    }
    
    var userid = null;
    
    // Get Existing Item Details
    $.ajax({
        url: 'http://localhost:8888/expedition/api/index.php/item/'+id,
        type: 'GET',
        dataType: 'json',
        success: function(data) {
            userid = data.record.userid
            $('#sender_name').val(data.record.user.name);
            $('#sender_email').val(data.record.user.email);
            $('#sender_contact').val(data.record.sender_contact);
            $('#sender_address').val(data.record.sender_address);
            $('#receiver_name').val(data.record.receiver_name);
            $('#receiver_contact').val(data.record.receiver_contact);
            $('#receiver_address').val(data.record.receiver_address);
            $('#item_desc').val(data.record.item_description);
            $('#item_weight').val(data.record.weight);
            $('#item_price').val(data.record.price);
            $('#courier_name').val(data.record.courier.name);
            // $('#courier_contact').text(data.record.courier_contact);
            $('#status').text(data.record.status.name);
        }
    });
    

    // Get List of Expedition Status
    $.ajax({
        url: 'http://localhost:8888/expedition/api/index.php/expedition-statuses',
        type: 'GET',
        dataType: 'json',
        success: function(data) {
            var $data = $('#status');
            var $counter = 1;
            
            data.records.forEach(function(item) {
                $data.append(`<option>${item.name}</option>`);
            });
        }
    });
    
    // Get List Of Courier
    $.ajax({
        url: 'http://localhost:8888/expedition/api/index.php/couriers',
        type: 'GET',
        dataType: 'json',
        success: function(data) {
            var $data = $('#courier');
            var $counter = 1;
            
            data.records.forEach(function(item) {
                $data.append(`<option>${item.name}</option>`);
            });
        }
    });
    
    // Update Item
    function updateItem() {
        $.ajax({
            url: 'http://localhost:8888/expedition/api/index.php/item/'+id,
            type: 'PUT',
            dataType: 'json',
            data: {
                userid:userid,
                sender_contact: $('#sender_contact').val(),
                sender_address: $('#sender_address').val(),
                receiver_name: $('#receiver_name').val(),
                receiver_contact: $('#receiver_contact').val(),
                receiver_address: $('#receiver_address').val(),
                item_description: $('#item_desc').val(),
                weight: $('#item_weight').val(),
                price: $('#item_price').val(),
                status_id: $('#status').val(),
                courier_id: $('#courier').val()
            },
            success: function(data) {
                console.log(data);
                window.location.href = 'http://localhost:8888/expedition/index.php/item';
            }
        });
    }
</script>
</html>